   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"user_mb_app.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.global	usSDiscInStart
  19              		.section	.bss.usSDiscInStart,"aw",%nobits
  20              		.align	1
  23              	usSDiscInStart:
  24 0000 0000     		.space	2
  25              		.comm	ucSDiscInBuf,0,4
  26              		.global	usSCoilStart
  27              		.section	.bss.usSCoilStart,"aw",%nobits
  28              		.align	1
  31              	usSCoilStart:
  32 0000 0000     		.space	2
  33              		.comm	ucSCoilBuf,0,4
  34              		.global	usSRegInStart
  35              		.section	.data.usSRegInStart,"aw",%progbits
  36              		.align	1
  39              	usSRegInStart:
  40 0000 E803     		.short	1000
  41              		.comm	usSRegInBuf,8,4
  42              		.global	usSRegHoldStart
  43              		.section	.bss.usSRegHoldStart,"aw",%nobits
  44              		.align	1
  47              	usSRegHoldStart:
  48 0000 0000     		.space	2
  49              		.comm	usSRegHoldBuf,0,4
  50              		.section	.text.eMBRegInputCB,"ax",%progbits
  51              		.align	2
  52              		.global	eMBRegInputCB
  53              		.thumb
  54              		.thumb_func
  56              	eMBRegInputCB:
  57              	.LFB29:
  58              		.file 1 "../FreeModbus/stm32/user_mb_app.c"
   1:../FreeModbus/stm32/user_mb_app.c **** /*
   2:../FreeModbus/stm32/user_mb_app.c ****  * FreeModbus Libary: user callback functions and buffer define in slave mode
   3:../FreeModbus/stm32/user_mb_app.c ****  * Copyright (C) 2013 Armink <armink.ztl@gmail.com>
   4:../FreeModbus/stm32/user_mb_app.c ****  *
   5:../FreeModbus/stm32/user_mb_app.c ****  * This library is free software; you can redistribute it and/or
   6:../FreeModbus/stm32/user_mb_app.c ****  * modify it under the terms of the GNU Lesser General Public
   7:../FreeModbus/stm32/user_mb_app.c ****  * License as published by the Free Software Foundation; either
   8:../FreeModbus/stm32/user_mb_app.c ****  * version 2.1 of the License, or (at your option) any later version.
   9:../FreeModbus/stm32/user_mb_app.c ****  *
  10:../FreeModbus/stm32/user_mb_app.c ****  * This library is distributed in the hope that it will be useful,
  11:../FreeModbus/stm32/user_mb_app.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  12:../FreeModbus/stm32/user_mb_app.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  13:../FreeModbus/stm32/user_mb_app.c ****  * Lesser General Public License for more details.
  14:../FreeModbus/stm32/user_mb_app.c ****  *
  15:../FreeModbus/stm32/user_mb_app.c ****  * You should have received a copy of the GNU Lesser General Public
  16:../FreeModbus/stm32/user_mb_app.c ****  * License along with this library; if not, write to the Free Software
  17:../FreeModbus/stm32/user_mb_app.c ****  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  18:../FreeModbus/stm32/user_mb_app.c ****  *
  19:../FreeModbus/stm32/user_mb_app.c ****  * File: $Id: user_mb_app.c,v 1.60 2013/11/23 11:49:05 Armink $
  20:../FreeModbus/stm32/user_mb_app.c ****  */
  21:../FreeModbus/stm32/user_mb_app.c **** #include "user_mb_app.h"
  22:../FreeModbus/stm32/user_mb_app.c **** 
  23:../FreeModbus/stm32/user_mb_app.c **** /*------------------------Slave mode use these variables----------------------*/
  24:../FreeModbus/stm32/user_mb_app.c **** //Slave mode:DiscreteInputs variables
  25:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSDiscInStart                               = S_DISCRETE_INPUT_START;
  26:../FreeModbus/stm32/user_mb_app.c **** #if S_DISCRETE_INPUT_NDISCRETES%8
  27:../FreeModbus/stm32/user_mb_app.c **** UCHAR    ucSDiscInBuf[S_DISCRETE_INPUT_NDISCRETES/8+1];
  28:../FreeModbus/stm32/user_mb_app.c **** #else
  29:../FreeModbus/stm32/user_mb_app.c **** UCHAR    ucSDiscInBuf[S_DISCRETE_INPUT_NDISCRETES/8]  ;
  30:../FreeModbus/stm32/user_mb_app.c **** #endif
  31:../FreeModbus/stm32/user_mb_app.c **** //Slave mode:Coils variables
  32:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSCoilStart                                 = S_COIL_START;
  33:../FreeModbus/stm32/user_mb_app.c **** #if S_COIL_NCOILS%8
  34:../FreeModbus/stm32/user_mb_app.c **** UCHAR    ucSCoilBuf[S_COIL_NCOILS/8+1]                ;
  35:../FreeModbus/stm32/user_mb_app.c **** #else
  36:../FreeModbus/stm32/user_mb_app.c **** UCHAR    ucSCoilBuf[S_COIL_NCOILS/8]                  ;
  37:../FreeModbus/stm32/user_mb_app.c **** #endif
  38:../FreeModbus/stm32/user_mb_app.c **** //Slave mode:InputRegister variables
  39:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSRegInStart                                = S_REG_INPUT_START;
  40:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSRegInBuf[S_REG_INPUT_NREGS]               ;
  41:../FreeModbus/stm32/user_mb_app.c **** //Slave mode:HoldingRegister variables
  42:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSRegHoldStart                              = S_REG_HOLDING_START;
  43:../FreeModbus/stm32/user_mb_app.c **** USHORT   usSRegHoldBuf[S_REG_HOLDING_NREGS]           ;
  44:../FreeModbus/stm32/user_mb_app.c **** //******************************ÊäÈë¼Ä´æÆ÷»Øµ÷º¯Êý**********************************
  45:../FreeModbus/stm32/user_mb_app.c **** //º¯Êý¶¨Òå: eMBErrorCode eMBRegInputCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs )
  46:../FreeModbus/stm32/user_mb_app.c **** //Ãè    Êö£ºÊäÈë¼Ä´æÆ÷Ïà¹ØµÄ¹¦ÄÜ£¨¶Á¡¢Á¬Ðø¶Á£©
  47:../FreeModbus/stm32/user_mb_app.c **** //Èë¿Ú²ÎÊý£ºpucRegBuffer : »Øµ÷º¯Êý½«Modbus¼Ä´æÆ÷µÄµ±Ç°ÖµÐ´ÈëµÄ»º³åÇø
  48:../FreeModbus/stm32/user_mb_app.c **** //			usAddress    : ¼Ä´æÆ÷µÄÆðÊ¼µØÖ·£¬ÊäÈë¼Ä´æÆ÷µÄµØÖ··¶Î§ÊÇ1-65535¡£
  49:../FreeModbus/stm32/user_mb_app.c **** //			usNRegs      : ¼Ä´æÆ÷ÊýÁ¿
  50:../FreeModbus/stm32/user_mb_app.c **** //³ö¿Ú²ÎÊý£ºeMBErrorCode : Õâ¸öº¯Êý½«·µ»ØµÄ´íÎóÂë
  51:../FreeModbus/stm32/user_mb_app.c **** //±¸    ×¢£ºEditor£ºArmink 2010-10-31    Company: BXXJS
  52:../FreeModbus/stm32/user_mb_app.c **** //**********************************************************************************
  53:../FreeModbus/stm32/user_mb_app.c **** eMBErrorCode
  54:../FreeModbus/stm32/user_mb_app.c **** eMBRegInputCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs )
  55:../FreeModbus/stm32/user_mb_app.c **** {
  59              		.loc 1 55 0
  60              		.cfi_startproc
  61              		@ args = 0, pretend = 0, frame = 24
  62              		@ frame_needed = 1, uses_anonymous_args = 0
  63              		@ link register save eliminated.
  64 0000 80B4     		push	{r7}
  65              		.cfi_def_cfa_offset 4
  66              		.cfi_offset 7, -4
  67 0002 87B0     		sub	sp, sp, #28
  68              		.cfi_def_cfa_offset 32
  69 0004 00AF     		add	r7, sp, #0
  70              		.cfi_def_cfa_register 7
  71 0006 7860     		str	r0, [r7, #4]
  72 0008 1346     		mov	r3, r2
  73 000a 0A46     		mov	r2, r1	@ movhi
  74 000c 7A80     		strh	r2, [r7, #2]	@ movhi
  75 000e 3B80     		strh	r3, [r7]	@ movhi
  56:../FreeModbus/stm32/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
  76              		.loc 1 56 0
  77 0010 0023     		movs	r3, #0
  78 0012 FB75     		strb	r3, [r7, #23]
  57:../FreeModbus/stm32/user_mb_app.c **** 
  58:../FreeModbus/stm32/user_mb_app.c ****     //USHORT          iRegIndex;
  59:../FreeModbus/stm32/user_mb_app.c ****     SHORT          iRegIndex;
  60:../FreeModbus/stm32/user_mb_app.c ****     USHORT *        pusRegInputBuf;
  61:../FreeModbus/stm32/user_mb_app.c ****     //UCHAR           REG_INPUT_START;
  62:../FreeModbus/stm32/user_mb_app.c ****     USHORT          REG_INPUT_START;
  63:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           REG_INPUT_NREGS;
  64:../FreeModbus/stm32/user_mb_app.c ****     //UCHAR           usRegInStart;
  65:../FreeModbus/stm32/user_mb_app.c ****     USHORT           usRegInStart;
  66:../FreeModbus/stm32/user_mb_app.c **** 
  67:../FreeModbus/stm32/user_mb_app.c **** 	pusRegInputBuf = usSRegInBuf;
  79              		.loc 1 67 0
  80 0014 40F20003 		movw	r3, #:lower16:usSRegInBuf
  81 0018 C0F20003 		movt	r3, #:upper16:usSRegInBuf
  82 001c 3B61     		str	r3, [r7, #16]
  68:../FreeModbus/stm32/user_mb_app.c **** 	REG_INPUT_START = S_REG_INPUT_START;
  83              		.loc 1 68 0
  84 001e 4FF47A73 		mov	r3, #1000
  85 0022 FB81     		strh	r3, [r7, #14]	@ movhi
  69:../FreeModbus/stm32/user_mb_app.c **** 	REG_INPUT_NREGS = S_REG_INPUT_NREGS;
  86              		.loc 1 69 0
  87 0024 0423     		movs	r3, #4
  88 0026 7B73     		strb	r3, [r7, #13]
  70:../FreeModbus/stm32/user_mb_app.c **** 	usRegInStart = usSRegInStart;
  89              		.loc 1 70 0
  90 0028 40F20003 		movw	r3, #:lower16:usSRegInStart
  91 002c C0F20003 		movt	r3, #:upper16:usSRegInStart
  92 0030 1B88     		ldrh	r3, [r3]	@ movhi
  93 0032 7B81     		strh	r3, [r7, #10]	@ movhi
  71:../FreeModbus/stm32/user_mb_app.c **** 
  72:../FreeModbus/stm32/user_mb_app.c **** 	usAddress--;//FreeModbus¹¦ÄÜº¯ÊýÖÐÒÑ¾­¼Ó1£¬Îª±£Ö¤Óë»º³åÇøÊ×µØÖ·Ò»ÖÂ£¬¹Ê¼õ1
  94              		.loc 1 72 0
  95 0034 7B88     		ldrh	r3, [r7, #2]
  96 0036 013B     		subs	r3, r3, #1
  97 0038 7B80     		strh	r3, [r7, #2]	@ movhi
  73:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= REG_INPUT_START )
  98              		.loc 1 73 0
  99 003a 7A88     		ldrh	r2, [r7, #2]
 100 003c FB89     		ldrh	r3, [r7, #14]
 101 003e 9A42     		cmp	r2, r3
 102 0040 2FD3     		bcc	.L2
  74:../FreeModbus/stm32/user_mb_app.c ****         && ( usAddress + usNRegs <= REG_INPUT_START + REG_INPUT_NREGS ) )
 103              		.loc 1 74 0
 104 0042 7A88     		ldrh	r2, [r7, #2]
 105 0044 3B88     		ldrh	r3, [r7]
 106 0046 1A44     		add	r2, r2, r3
 107 0048 F989     		ldrh	r1, [r7, #14]
 108 004a 7B7B     		ldrb	r3, [r7, #13]	@ zero_extendqisi2
 109 004c 0B44     		add	r3, r3, r1
 110 004e 9A42     		cmp	r2, r3
 111 0050 27DC     		bgt	.L2
  75:../FreeModbus/stm32/user_mb_app.c ****     {
  76:../FreeModbus/stm32/user_mb_app.c ****         iRegIndex = ( int )( usAddress - usRegInStart);
 112              		.loc 1 76 0
 113 0052 7A88     		ldrh	r2, [r7, #2]	@ movhi
 114 0054 7B89     		ldrh	r3, [r7, #10]	@ movhi
 115 0056 D31A     		subs	r3, r2, r3
 116 0058 9BB2     		uxth	r3, r3
 117 005a BB82     		strh	r3, [r7, #20]	@ movhi
  77:../FreeModbus/stm32/user_mb_app.c ****         while( usNRegs > 0 )
 118              		.loc 1 77 0
 119 005c 1DE0     		b	.L3
 120              	.L4:
  78:../FreeModbus/stm32/user_mb_app.c ****         {
  79:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer++ = (unsigned char) (pusRegInputBuf[iRegIndex] >> 8);
 121              		.loc 1 79 0
 122 005e 7B68     		ldr	r3, [r7, #4]
 123 0060 5A1C     		adds	r2, r3, #1
 124 0062 7A60     		str	r2, [r7, #4]
 125 0064 B7F91420 		ldrsh	r2, [r7, #20]
 126 0068 5200     		lsls	r2, r2, #1
 127 006a 3969     		ldr	r1, [r7, #16]
 128 006c 0A44     		add	r2, r2, r1
 129 006e 1288     		ldrh	r2, [r2]
 130 0070 120A     		lsrs	r2, r2, #8
 131 0072 92B2     		uxth	r2, r2
 132 0074 D2B2     		uxtb	r2, r2
 133 0076 1A70     		strb	r2, [r3]
  80:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer++ = ( unsigned char )( pusRegInputBuf[iRegIndex] & 0xFF );
 134              		.loc 1 80 0
 135 0078 7B68     		ldr	r3, [r7, #4]
 136 007a 5A1C     		adds	r2, r3, #1
 137 007c 7A60     		str	r2, [r7, #4]
 138 007e B7F91420 		ldrsh	r2, [r7, #20]
 139 0082 5200     		lsls	r2, r2, #1
 140 0084 3969     		ldr	r1, [r7, #16]
 141 0086 0A44     		add	r2, r2, r1
 142 0088 1288     		ldrh	r2, [r2]
 143 008a D2B2     		uxtb	r2, r2
 144 008c 1A70     		strb	r2, [r3]
  81:../FreeModbus/stm32/user_mb_app.c ****             iRegIndex++;
 145              		.loc 1 81 0
 146 008e BB8A     		ldrh	r3, [r7, #20]
 147 0090 0133     		adds	r3, r3, #1
 148 0092 BB82     		strh	r3, [r7, #20]	@ movhi
  82:../FreeModbus/stm32/user_mb_app.c ****             usNRegs--;
 149              		.loc 1 82 0
 150 0094 3B88     		ldrh	r3, [r7]
 151 0096 013B     		subs	r3, r3, #1
 152 0098 3B80     		strh	r3, [r7]	@ movhi
 153              	.L3:
  77:../FreeModbus/stm32/user_mb_app.c ****         {
 154              		.loc 1 77 0 discriminator 1
 155 009a 3B88     		ldrh	r3, [r7]
 156 009c 002B     		cmp	r3, #0
 157 009e DED1     		bne	.L4
  73:../FreeModbus/stm32/user_mb_app.c ****         && ( usAddress + usNRegs <= REG_INPUT_START + REG_INPUT_NREGS ) )
 158              		.loc 1 73 0
 159 00a0 01E0     		b	.L5
 160              	.L2:
  83:../FreeModbus/stm32/user_mb_app.c ****         }
  84:../FreeModbus/stm32/user_mb_app.c ****     }
  85:../FreeModbus/stm32/user_mb_app.c ****     else
  86:../FreeModbus/stm32/user_mb_app.c ****     {
  87:../FreeModbus/stm32/user_mb_app.c ****         eStatus = MB_ENOREG;
 161              		.loc 1 87 0
 162 00a2 0123     		movs	r3, #1
 163 00a4 FB75     		strb	r3, [r7, #23]
 164              	.L5:
  88:../FreeModbus/stm32/user_mb_app.c ****     }
  89:../FreeModbus/stm32/user_mb_app.c **** 
  90:../FreeModbus/stm32/user_mb_app.c ****     return eStatus;
 165              		.loc 1 90 0
 166 00a6 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
  91:../FreeModbus/stm32/user_mb_app.c **** }
 167              		.loc 1 91 0
 168 00a8 1846     		mov	r0, r3
 169 00aa 1C37     		adds	r7, r7, #28
 170 00ac BD46     		mov	sp, r7
 171              		@ sp needed
 172 00ae 5DF8047B 		ldr	r7, [sp], #4
 173 00b2 7047     		bx	lr
 174              		.cfi_endproc
 175              	.LFE29:
 177              		.section	.text.eMBRegHoldingCB,"ax",%progbits
 178              		.align	2
 179              		.global	eMBRegHoldingCB
 180              		.thumb
 181              		.thumb_func
 183              	eMBRegHoldingCB:
 184              	.LFB30:
  92:../FreeModbus/stm32/user_mb_app.c **** //******************************±£³Ö¼Ä´æÆ÷»Øµ÷º¯Êý**********************************
  93:../FreeModbus/stm32/user_mb_app.c **** //º¯Êý¶¨Òå: eMBErrorCode eMBRegHoldingCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs, e
  94:../FreeModbus/stm32/user_mb_app.c **** //Ãè    Êö£º±£³Ö¼Ä´æÆ÷Ïà¹ØµÄ¹¦ÄÜ£¨¶Á¡¢Á¬Ðø¶Á¡¢Ð´¡¢Á¬ÐøÐ´£©
  95:../FreeModbus/stm32/user_mb_app.c **** //Èë¿Ú²ÎÊý£ºpucRegBuffer : Èç¹ûÐèÒª¸üÐÂÓÃ»§¼Ä´æÆ÷ÊýÖµ£¬Õâ¸ö»º³åÇø±ØÐëÖ¸ÏòÐÂµÄ¼Ä´æÆ÷ÊýÖµ¡£
  96:../FreeModbus/stm32/user_mb_app.c **** //                         Èç¹ûÐ­ÒéÕ»ÏëÖªµÀµ±Ç°µÄÊýÖµ£¬»Øµ÷º¯Êý±ØÐë½«µ±Ç°ÖµÐ´ÈëÕâ¸ö»º³åÇø
  97:../FreeModbus/stm32/user_mb_app.c **** //			usAddress    : ¼Ä´æÆ÷µÄÆðÊ¼µØÖ·¡£
  98:../FreeModbus/stm32/user_mb_app.c **** //			usNRegs      : ¼Ä´æÆ÷ÊýÁ¿
  99:../FreeModbus/stm32/user_mb_app.c **** //          eMode        : Èç¹û¸Ã²ÎÊýÎªeMBRegisterMode::MB_REG_WRITE£¬ÓÃ»§µÄÓ¦ÓÃÊýÖµ½«´ÓpucRegBuffe
 100:../FreeModbus/stm32/user_mb_app.c **** //                         Èç¹û¸Ã²ÎÊýÎªeMBRegisterMode::MB_REG_READ£¬ÓÃ»§ÐèÒª½«µ±Ç°µÄÓ¦ÓÃÊý¾Ý´æ´¢ÔÚ
 101:../FreeModbus/stm32/user_mb_app.c **** //³ö¿Ú²ÎÊý£ºeMBErrorCode : Õâ¸öº¯Êý½«·µ»ØµÄ´íÎóÂë
 102:../FreeModbus/stm32/user_mb_app.c **** //±¸    ×¢£ºEditor£ºArmink 2010-10-31    Company: BXXJS
 103:../FreeModbus/stm32/user_mb_app.c **** //**********************************************************************************
 104:../FreeModbus/stm32/user_mb_app.c **** eMBErrorCode
 105:../FreeModbus/stm32/user_mb_app.c **** eMBRegHoldingCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs, eMBRegisterMode eMode )
 106:../FreeModbus/stm32/user_mb_app.c **** {
 185              		.loc 1 106 0
 186              		.cfi_startproc
 187              		@ args = 0, pretend = 0, frame = 32
 188              		@ frame_needed = 1, uses_anonymous_args = 0
 189              		@ link register save eliminated.
 190 0000 80B4     		push	{r7}
 191              		.cfi_def_cfa_offset 4
 192              		.cfi_offset 7, -4
 193 0002 89B0     		sub	sp, sp, #36
 194              		.cfi_def_cfa_offset 40
 195 0004 00AF     		add	r7, sp, #0
 196              		.cfi_def_cfa_register 7
 197 0006 F860     		str	r0, [r7, #12]
 198 0008 7981     		strh	r1, [r7, #10]	@ movhi
 199 000a 3A81     		strh	r2, [r7, #8]	@ movhi
 200 000c FB71     		strb	r3, [r7, #7]
 107:../FreeModbus/stm32/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 201              		.loc 1 107 0
 202 000e 0023     		movs	r3, #0
 203 0010 FB77     		strb	r3, [r7, #31]
 108:../FreeModbus/stm32/user_mb_app.c ****     USHORT          iRegIndex;
 109:../FreeModbus/stm32/user_mb_app.c ****     USHORT *        pusRegHoldingBuf;
 110:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           REG_HOLDING_START;
 111:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           REG_HOLDING_NREGS;
 112:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           usRegHoldStart;
 113:../FreeModbus/stm32/user_mb_app.c **** 
 114:../FreeModbus/stm32/user_mb_app.c **** 	pusRegHoldingBuf = usSRegHoldBuf;
 204              		.loc 1 114 0
 205 0012 40F20003 		movw	r3, #:lower16:usSRegHoldBuf
 206 0016 C0F20003 		movt	r3, #:upper16:usSRegHoldBuf
 207 001a BB61     		str	r3, [r7, #24]
 115:../FreeModbus/stm32/user_mb_app.c **** 	REG_HOLDING_START = S_REG_HOLDING_START;
 208              		.loc 1 115 0
 209 001c 0023     		movs	r3, #0
 210 001e FB75     		strb	r3, [r7, #23]
 116:../FreeModbus/stm32/user_mb_app.c **** 	REG_HOLDING_NREGS = S_REG_HOLDING_NREGS;
 211              		.loc 1 116 0
 212 0020 0023     		movs	r3, #0
 213 0022 BB75     		strb	r3, [r7, #22]
 117:../FreeModbus/stm32/user_mb_app.c **** 	usRegHoldStart = usSRegHoldStart;
 214              		.loc 1 117 0
 215 0024 40F20003 		movw	r3, #:lower16:usSRegHoldStart
 216 0028 C0F20003 		movt	r3, #:upper16:usSRegHoldStart
 217 002c 1B88     		ldrh	r3, [r3]
 218 002e 7B75     		strb	r3, [r7, #21]
 118:../FreeModbus/stm32/user_mb_app.c **** 
 119:../FreeModbus/stm32/user_mb_app.c **** 	usAddress--;//FreeModbus¹¦ÄÜº¯ÊýÖÐÒÑ¾­¼Ó1£¬Îª±£Ö¤Óë»º³åÇøÊ×µØÖ·Ò»ÖÂ£¬¹Ê¼õ1
 219              		.loc 1 119 0
 220 0030 7B89     		ldrh	r3, [r7, #10]
 221 0032 013B     		subs	r3, r3, #1
 222 0034 7B81     		strh	r3, [r7, #10]	@ movhi
 120:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= REG_HOLDING_START ) &&
 223              		.loc 1 120 0
 224 0036 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 225 0038 9BB2     		uxth	r3, r3
 226 003a 7A89     		ldrh	r2, [r7, #10]
 227 003c 9A42     		cmp	r2, r3
 228 003e 58D3     		bcc	.L8
 121:../FreeModbus/stm32/user_mb_app.c ****         ( usAddress + usNRegs <= REG_HOLDING_START + REG_HOLDING_NREGS ) )
 229              		.loc 1 121 0 discriminator 1
 230 0040 7A89     		ldrh	r2, [r7, #10]
 231 0042 3B89     		ldrh	r3, [r7, #8]
 232 0044 1A44     		add	r2, r2, r3
 233 0046 F97D     		ldrb	r1, [r7, #23]	@ zero_extendqisi2
 234 0048 BB7D     		ldrb	r3, [r7, #22]	@ zero_extendqisi2
 235 004a 0B44     		add	r3, r3, r1
 120:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= REG_HOLDING_START ) &&
 236              		.loc 1 120 0 discriminator 1
 237 004c 9A42     		cmp	r2, r3
 238 004e 50DC     		bgt	.L8
 122:../FreeModbus/stm32/user_mb_app.c ****     {
 123:../FreeModbus/stm32/user_mb_app.c ****         iRegIndex = usAddress - usRegHoldStart;
 239              		.loc 1 123 0
 240 0050 7B7D     		ldrb	r3, [r7, #21]	@ zero_extendqisi2
 241 0052 9BB2     		uxth	r3, r3
 242 0054 7A89     		ldrh	r2, [r7, #10]	@ movhi
 243 0056 D31A     		subs	r3, r2, r3
 244 0058 BB83     		strh	r3, [r7, #28]	@ movhi
 124:../FreeModbus/stm32/user_mb_app.c ****         switch ( eMode )
 245              		.loc 1 124 0
 246 005a FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 247 005c 002B     		cmp	r3, #0
 248 005e 1ED0     		beq	.L12
 249 0060 012B     		cmp	r3, #1
 250 0062 41D0     		beq	.L14
 125:../FreeModbus/stm32/user_mb_app.c ****         {
 126:../FreeModbus/stm32/user_mb_app.c ****             /* Pass current register values to the protocol stack. */
 127:../FreeModbus/stm32/user_mb_app.c ****         case MB_REG_READ:
 128:../FreeModbus/stm32/user_mb_app.c ****             while( usNRegs > 0 )
 129:../FreeModbus/stm32/user_mb_app.c ****             {
 130:../FreeModbus/stm32/user_mb_app.c **** 				*pucRegBuffer++ = ( unsigned char )( pusRegHoldingBuf[iRegIndex] >> 8 );
 131:../FreeModbus/stm32/user_mb_app.c **** 				*pucRegBuffer++ = ( unsigned char )( pusRegHoldingBuf[iRegIndex] & 0xFF );
 132:../FreeModbus/stm32/user_mb_app.c ****                 iRegIndex++;
 133:../FreeModbus/stm32/user_mb_app.c ****                 usNRegs--;
 134:../FreeModbus/stm32/user_mb_app.c ****             }
 135:../FreeModbus/stm32/user_mb_app.c ****             break;
 136:../FreeModbus/stm32/user_mb_app.c **** 
 137:../FreeModbus/stm32/user_mb_app.c ****             /* Update current register values with new values from the
 138:../FreeModbus/stm32/user_mb_app.c ****              * protocol stack. */
 139:../FreeModbus/stm32/user_mb_app.c ****         case MB_REG_WRITE:
 140:../FreeModbus/stm32/user_mb_app.c ****             while( usNRegs > 0 )
 141:../FreeModbus/stm32/user_mb_app.c ****             {
 142:../FreeModbus/stm32/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] = *pucRegBuffer++ << 8;
 143:../FreeModbus/stm32/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] |= *pucRegBuffer++;
 144:../FreeModbus/stm32/user_mb_app.c ****                 iRegIndex++;
 145:../FreeModbus/stm32/user_mb_app.c ****                 usNRegs--;
 146:../FreeModbus/stm32/user_mb_app.c ****             }
 147:../FreeModbus/stm32/user_mb_app.c ****             break;
 148:../FreeModbus/stm32/user_mb_app.c ****         }
 149:../FreeModbus/stm32/user_mb_app.c ****     }
 251              		.loc 1 149 0
 252 0064 47E0     		b	.L16
 253              	.L13:
 130:../FreeModbus/stm32/user_mb_app.c **** 				*pucRegBuffer++ = ( unsigned char )( pusRegHoldingBuf[iRegIndex] & 0xFF );
 254              		.loc 1 130 0
 255 0066 FB68     		ldr	r3, [r7, #12]
 256 0068 5A1C     		adds	r2, r3, #1
 257 006a FA60     		str	r2, [r7, #12]
 258 006c BA8B     		ldrh	r2, [r7, #28]
 259 006e 5200     		lsls	r2, r2, #1
 260 0070 B969     		ldr	r1, [r7, #24]
 261 0072 0A44     		add	r2, r2, r1
 262 0074 1288     		ldrh	r2, [r2]
 263 0076 120A     		lsrs	r2, r2, #8
 264 0078 92B2     		uxth	r2, r2
 265 007a D2B2     		uxtb	r2, r2
 266 007c 1A70     		strb	r2, [r3]
 131:../FreeModbus/stm32/user_mb_app.c ****                 iRegIndex++;
 267              		.loc 1 131 0
 268 007e FB68     		ldr	r3, [r7, #12]
 269 0080 5A1C     		adds	r2, r3, #1
 270 0082 FA60     		str	r2, [r7, #12]
 271 0084 BA8B     		ldrh	r2, [r7, #28]
 272 0086 5200     		lsls	r2, r2, #1
 273 0088 B969     		ldr	r1, [r7, #24]
 274 008a 0A44     		add	r2, r2, r1
 275 008c 1288     		ldrh	r2, [r2]
 276 008e D2B2     		uxtb	r2, r2
 277 0090 1A70     		strb	r2, [r3]
 132:../FreeModbus/stm32/user_mb_app.c ****                 usNRegs--;
 278              		.loc 1 132 0
 279 0092 BB8B     		ldrh	r3, [r7, #28]
 280 0094 0133     		adds	r3, r3, #1
 281 0096 BB83     		strh	r3, [r7, #28]	@ movhi
 133:../FreeModbus/stm32/user_mb_app.c ****             }
 282              		.loc 1 133 0
 283 0098 3B89     		ldrh	r3, [r7, #8]
 284 009a 013B     		subs	r3, r3, #1
 285 009c 3B81     		strh	r3, [r7, #8]	@ movhi
 286              	.L12:
 128:../FreeModbus/stm32/user_mb_app.c ****             {
 287              		.loc 1 128 0 discriminator 1
 288 009e 3B89     		ldrh	r3, [r7, #8]
 289 00a0 002B     		cmp	r3, #0
 290 00a2 E0D1     		bne	.L13
 135:../FreeModbus/stm32/user_mb_app.c **** 
 291              		.loc 1 135 0
 292 00a4 24E0     		b	.L9
 293              	.L15:
 142:../FreeModbus/stm32/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] |= *pucRegBuffer++;
 294              		.loc 1 142 0
 295 00a6 BB8B     		ldrh	r3, [r7, #28]
 296 00a8 5B00     		lsls	r3, r3, #1
 297 00aa BA69     		ldr	r2, [r7, #24]
 298 00ac 1A44     		add	r2, r2, r3
 299 00ae FB68     		ldr	r3, [r7, #12]
 300 00b0 591C     		adds	r1, r3, #1
 301 00b2 F960     		str	r1, [r7, #12]
 302 00b4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 303 00b6 1B02     		lsls	r3, r3, #8
 304 00b8 9BB2     		uxth	r3, r3
 305 00ba 1380     		strh	r3, [r2]	@ movhi
 143:../FreeModbus/stm32/user_mb_app.c ****                 iRegIndex++;
 306              		.loc 1 143 0
 307 00bc BB8B     		ldrh	r3, [r7, #28]
 308 00be 5B00     		lsls	r3, r3, #1
 309 00c0 BA69     		ldr	r2, [r7, #24]
 310 00c2 1A44     		add	r2, r2, r3
 311 00c4 BB8B     		ldrh	r3, [r7, #28]
 312 00c6 5B00     		lsls	r3, r3, #1
 313 00c8 B969     		ldr	r1, [r7, #24]
 314 00ca 0B44     		add	r3, r3, r1
 315 00cc 1988     		ldrh	r1, [r3]
 316 00ce FB68     		ldr	r3, [r7, #12]
 317 00d0 581C     		adds	r0, r3, #1
 318 00d2 F860     		str	r0, [r7, #12]
 319 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 320 00d6 0B43     		orrs	r3, r3, r1
 321 00d8 9BB2     		uxth	r3, r3
 322 00da 1380     		strh	r3, [r2]	@ movhi
 144:../FreeModbus/stm32/user_mb_app.c ****                 usNRegs--;
 323              		.loc 1 144 0
 324 00dc BB8B     		ldrh	r3, [r7, #28]
 325 00de 0133     		adds	r3, r3, #1
 326 00e0 BB83     		strh	r3, [r7, #28]	@ movhi
 145:../FreeModbus/stm32/user_mb_app.c ****             }
 327              		.loc 1 145 0
 328 00e2 3B89     		ldrh	r3, [r7, #8]
 329 00e4 013B     		subs	r3, r3, #1
 330 00e6 3B81     		strh	r3, [r7, #8]	@ movhi
 331              	.L14:
 140:../FreeModbus/stm32/user_mb_app.c ****             {
 332              		.loc 1 140 0 discriminator 1
 333 00e8 3B89     		ldrh	r3, [r7, #8]
 334 00ea 002B     		cmp	r3, #0
 335 00ec DBD1     		bne	.L15
 147:../FreeModbus/stm32/user_mb_app.c ****         }
 336              		.loc 1 147 0
 337 00ee 00BF     		nop
 338              	.L9:
 339              		.loc 1 149 0
 340 00f0 01E0     		b	.L16
 341              	.L8:
 150:../FreeModbus/stm32/user_mb_app.c ****     else
 151:../FreeModbus/stm32/user_mb_app.c ****     {
 152:../FreeModbus/stm32/user_mb_app.c ****         eStatus = MB_ENOREG;
 342              		.loc 1 152 0
 343 00f2 0123     		movs	r3, #1
 344 00f4 FB77     		strb	r3, [r7, #31]
 345              	.L16:
 153:../FreeModbus/stm32/user_mb_app.c ****     }
 154:../FreeModbus/stm32/user_mb_app.c ****     return eStatus;
 346              		.loc 1 154 0
 347 00f6 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 155:../FreeModbus/stm32/user_mb_app.c **** }
 348              		.loc 1 155 0
 349 00f8 1846     		mov	r0, r3
 350 00fa 2437     		adds	r7, r7, #36
 351 00fc BD46     		mov	sp, r7
 352              		@ sp needed
 353 00fe 5DF8047B 		ldr	r7, [sp], #4
 354 0102 7047     		bx	lr
 355              		.cfi_endproc
 356              	.LFE30:
 358              		.section	.text.eMBRegCoilsCB,"ax",%progbits
 359              		.align	2
 360              		.global	eMBRegCoilsCB
 361              		.thumb
 362              		.thumb_func
 364              	eMBRegCoilsCB:
 365              	.LFB31:
 156:../FreeModbus/stm32/user_mb_app.c **** //****************************ÏßÈ¦×´Ì¬¼Ä´æÆ÷»Øµ÷º¯Êý********************************
 157:../FreeModbus/stm32/user_mb_app.c **** //º¯Êý¶¨Òå: eMBErrorCode eMBRegCoilsCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNCoils, eM
 158:../FreeModbus/stm32/user_mb_app.c **** //Ãè    Êö£ºÏßÈ¦×´Ì¬¼Ä´æÆ÷Ïà¹ØµÄ¹¦ÄÜ£¨¶Á¡¢Á¬Ðø¶Á¡¢Ð´¡¢Á¬ÐøÐ´£©
 159:../FreeModbus/stm32/user_mb_app.c **** //Èë¿Ú²ÎÊý£ºpucRegBuffer : Î»×é³ÉÒ»¸ö×Ö½Ú£¬ÆðÊ¼¼Ä´æÆ÷¶ÔÓ¦µÄÎ»´¦ÓÚ¸Ã×Ö½ÚpucRegBufferµÄ×îµÍÎ»LSB¡£
 160:../FreeModbus/stm32/user_mb_app.c **** //                         Èç¹û»Øµ÷º¯ÊýÒªÐ´Õâ¸ö»º³åÇø£¬Ã»ÓÐÓÃµ½µÄÏßÈ¦£¨ÀýÈç²»ÊÇ8¸öÒ»×éµÄÏßÈ¦×´Ì¬£©¶
 161:../FreeModbus/stm32/user_mb_app.c **** //			usAddress    : µÚÒ»¸öÏßÈ¦µØÖ·¡£
 162:../FreeModbus/stm32/user_mb_app.c **** //			usNCoils     : ÇëÇóµÄÏßÈ¦¸öÊý
 163:../FreeModbus/stm32/user_mb_app.c **** //          eMode        £»Èç¹û¸Ã²ÎÊýÎªeMBRegisterMode::MB_REG_WRITE£¬ÓÃ»§µÄÓ¦ÓÃÊýÖµ½«´ÓpucRegBuffe
 164:../FreeModbus/stm32/user_mb_app.c **** //                         Èç¹û¸Ã²ÎÊýÎªeMBRegisterMode::MB_REG_READ£¬ÓÃ»§ÐèÒª½«µ±Ç°µÄÓ¦ÓÃÊý¾Ý´æ´¢ÔÚ
 165:../FreeModbus/stm32/user_mb_app.c **** //³ö¿Ú²ÎÊý£ºeMBErrorCode : Õâ¸öº¯Êý½«·µ»ØµÄ´íÎóÂë
 166:../FreeModbus/stm32/user_mb_app.c **** //±¸    ×¢£ºEditor£ºArmink 2010-10-31    Company: BXXJS
 167:../FreeModbus/stm32/user_mb_app.c **** //**********************************************************************************
 168:../FreeModbus/stm32/user_mb_app.c **** eMBErrorCode
 169:../FreeModbus/stm32/user_mb_app.c **** eMBRegCoilsCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNCoils, eMBRegisterMode eMode )
 170:../FreeModbus/stm32/user_mb_app.c **** {
 366              		.loc 1 170 0
 367              		.cfi_startproc
 368              		@ args = 0, pretend = 0, frame = 40
 369              		@ frame_needed = 1, uses_anonymous_args = 0
 370 0000 90B5     		push	{r4, r7, lr}
 371              		.cfi_def_cfa_offset 12
 372              		.cfi_offset 4, -12
 373              		.cfi_offset 7, -8
 374              		.cfi_offset 14, -4
 375 0002 8BB0     		sub	sp, sp, #44
 376              		.cfi_def_cfa_offset 56
 377 0004 00AF     		add	r7, sp, #0
 378              		.cfi_def_cfa_register 7
 379 0006 F860     		str	r0, [r7, #12]
 380 0008 7981     		strh	r1, [r7, #10]	@ movhi
 381 000a 3A81     		strh	r2, [r7, #8]	@ movhi
 382 000c FB71     		strb	r3, [r7, #7]
 171:../FreeModbus/stm32/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 383              		.loc 1 171 0
 384 000e 0023     		movs	r3, #0
 385 0010 87F82730 		strb	r3, [r7, #39]
 172:../FreeModbus/stm32/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 173:../FreeModbus/stm32/user_mb_app.c **** 	UCHAR *         pucCoilBuf;
 174:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           COIL_START;
 175:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           COIL_NCOILS;
 176:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           usCoilStart;
 177:../FreeModbus/stm32/user_mb_app.c ****     iNReg =  usNCoils / 8 + 1;        //Õ¼ÓÃ¼Ä´æÆ÷ÊýÁ¿
 386              		.loc 1 177 0
 387 0014 3B89     		ldrh	r3, [r7, #8]
 388 0016 DB08     		lsrs	r3, r3, #3
 389 0018 9BB2     		uxth	r3, r3
 390 001a 0133     		adds	r3, r3, #1
 391 001c 7B84     		strh	r3, [r7, #34]	@ movhi
 178:../FreeModbus/stm32/user_mb_app.c **** 
 179:../FreeModbus/stm32/user_mb_app.c **** 	pucCoilBuf = ucSCoilBuf;
 392              		.loc 1 179 0
 393 001e 40F20003 		movw	r3, #:lower16:ucSCoilBuf
 394 0022 C0F20003 		movt	r3, #:upper16:ucSCoilBuf
 395 0026 FB61     		str	r3, [r7, #28]
 180:../FreeModbus/stm32/user_mb_app.c **** 	COIL_START = S_COIL_START;
 396              		.loc 1 180 0
 397 0028 0023     		movs	r3, #0
 398 002a FB76     		strb	r3, [r7, #27]
 181:../FreeModbus/stm32/user_mb_app.c **** 	COIL_NCOILS = S_COIL_NCOILS;
 399              		.loc 1 181 0
 400 002c 0023     		movs	r3, #0
 401 002e BB76     		strb	r3, [r7, #26]
 182:../FreeModbus/stm32/user_mb_app.c **** 	usCoilStart = usSCoilStart;
 402              		.loc 1 182 0
 403 0030 40F20003 		movw	r3, #:lower16:usSCoilStart
 404 0034 C0F20003 		movt	r3, #:upper16:usSCoilStart
 405 0038 1B88     		ldrh	r3, [r3]
 406 003a 7B76     		strb	r3, [r7, #25]
 183:../FreeModbus/stm32/user_mb_app.c **** 
 184:../FreeModbus/stm32/user_mb_app.c **** 	usAddress--;//FreeModbus¹¦ÄÜº¯ÊýÖÐÒÑ¾­¼Ó1£¬Îª±£Ö¤Óë»º³åÇøÊ×µØÖ·Ò»ÖÂ£¬¹Ê¼õ1
 407              		.loc 1 184 0
 408 003c 7B89     		ldrh	r3, [r7, #10]
 409 003e 013B     		subs	r3, r3, #1
 410 0040 7B81     		strh	r3, [r7, #10]	@ movhi
 185:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= COIL_START ) &&
 411              		.loc 1 185 0
 412 0042 FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 413 0044 9BB2     		uxth	r3, r3
 414 0046 7A89     		ldrh	r2, [r7, #10]
 415 0048 9A42     		cmp	r2, r3
 416 004a C0F08280 		bcc	.L19
 186:../FreeModbus/stm32/user_mb_app.c ****         ( usAddress + usNCoils <= COIL_START + COIL_NCOILS ) )
 417              		.loc 1 186 0 discriminator 1
 418 004e 7A89     		ldrh	r2, [r7, #10]
 419 0050 3B89     		ldrh	r3, [r7, #8]
 420 0052 1A44     		add	r2, r2, r3
 421 0054 F97E     		ldrb	r1, [r7, #27]	@ zero_extendqisi2
 422 0056 BB7E     		ldrb	r3, [r7, #26]	@ zero_extendqisi2
 423 0058 0B44     		add	r3, r3, r1
 185:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= COIL_START ) &&
 424              		.loc 1 185 0 discriminator 1
 425 005a 9A42     		cmp	r2, r3
 426 005c 79DC     		bgt	.L19
 187:../FreeModbus/stm32/user_mb_app.c ****     {
 188:../FreeModbus/stm32/user_mb_app.c ****         iRegIndex    = ( int )( usAddress - usCoilStart ) / 8 ;    //Ã¿¸ö¼Ä´æÆ÷´æ8¸ö
 427              		.loc 1 188 0
 428 005e 7A89     		ldrh	r2, [r7, #10]
 429 0060 7B7E     		ldrb	r3, [r7, #25]	@ zero_extendqisi2
 430 0062 D31A     		subs	r3, r2, r3
 431 0064 DA1D     		adds	r2, r3, #7
 432 0066 002B     		cmp	r3, #0
 433 0068 B8BF     		it	lt
 434 006a 1346     		movlt	r3, r2
 435 006c DB10     		asrs	r3, r3, #3
 436 006e BB84     		strh	r3, [r7, #36]	@ movhi
 189:../FreeModbus/stm32/user_mb_app.c **** 		iRegBitIndex = ( int )( usAddress - usCoilStart ) % 8 ;	   //Ïà¶ÔÓÚ¼Ä´æÆ÷ÄÚ²¿µÄÎ»µØÖ·
 437              		.loc 1 189 0
 438 0070 7A89     		ldrh	r2, [r7, #10]
 439 0072 7B7E     		ldrb	r3, [r7, #25]	@ zero_extendqisi2
 440 0074 D21A     		subs	r2, r2, r3
 441 0076 D317     		asrs	r3, r2, #31
 442 0078 5B0F     		lsrs	r3, r3, #29
 443 007a 1A44     		add	r2, r2, r3
 444 007c 02F00702 		and	r2, r2, #7
 445 0080 D31A     		subs	r3, r2, r3
 446 0082 FB82     		strh	r3, [r7, #22]	@ movhi
 190:../FreeModbus/stm32/user_mb_app.c ****         switch ( eMode )
 447              		.loc 1 190 0
 448 0084 FB79     		ldrb	r3, [r7, #7]	@ zero_extendqisi2
 449 0086 002B     		cmp	r3, #0
 450 0088 15D0     		beq	.L23
 451 008a 012B     		cmp	r3, #1
 452 008c 46D0     		beq	.L25
 191:../FreeModbus/stm32/user_mb_app.c ****         {
 192:../FreeModbus/stm32/user_mb_app.c ****             /* Pass current coil values to the protocol stack. */
 193:../FreeModbus/stm32/user_mb_app.c ****         case MB_REG_READ:
 194:../FreeModbus/stm32/user_mb_app.c ****             while( iNReg > 0 )
 195:../FreeModbus/stm32/user_mb_app.c ****             {
 196:../FreeModbus/stm32/user_mb_app.c **** 				*pucRegBuffer++ = xMBUtilGetBits(&pucCoilBuf[iRegIndex++] , iRegBitIndex , 8);
 197:../FreeModbus/stm32/user_mb_app.c ****                 iNReg --;
 198:../FreeModbus/stm32/user_mb_app.c ****             }
 199:../FreeModbus/stm32/user_mb_app.c **** 			pucRegBuffer --;
 200:../FreeModbus/stm32/user_mb_app.c **** 			usNCoils = usNCoils % 8;                        //ÓàÏÂµÄÏßÈ¦Êý	
 201:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer = *pucRegBuffer <<(8 - usNCoils); //¸ßÎ»²¹Áã
 202:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer = *pucRegBuffer >>(8 - usNCoils);
 203:../FreeModbus/stm32/user_mb_app.c ****             break;
 204:../FreeModbus/stm32/user_mb_app.c **** 
 205:../FreeModbus/stm32/user_mb_app.c ****             /* Update current coil values with new values from the
 206:../FreeModbus/stm32/user_mb_app.c ****              * protocol stack. */
 207:../FreeModbus/stm32/user_mb_app.c ****         case MB_REG_WRITE:
 208:../FreeModbus/stm32/user_mb_app.c ****             while(iNReg > 1)									 //×îºóÃæÓàÏÂÀ´µÄÊýµ¥¶ÀËã
 209:../FreeModbus/stm32/user_mb_app.c ****             {
 210:../FreeModbus/stm32/user_mb_app.c **** 				xMBUtilSetBits(&pucCoilBuf[iRegIndex++] , iRegBitIndex  , 8 , *pucRegBuffer++);
 211:../FreeModbus/stm32/user_mb_app.c ****                 iNReg--;
 212:../FreeModbus/stm32/user_mb_app.c ****             }
 213:../FreeModbus/stm32/user_mb_app.c **** 			usNCoils = usNCoils % 8;                            //ÓàÏÂµÄÏßÈ¦Êý
 214:../FreeModbus/stm32/user_mb_app.c **** 			if (usNCoils != 0)                                  //xMBUtilSetBits·½·¨ ÔÚ²Ù×÷Î»ÊýÁ¿Îª0Ê±´æÔÚbu
 215:../FreeModbus/stm32/user_mb_app.c **** 			{
 216:../FreeModbus/stm32/user_mb_app.c **** 				xMBUtilSetBits(&pucCoilBuf[iRegIndex++], iRegBitIndex, usNCoils,
 217:../FreeModbus/stm32/user_mb_app.c **** 						*pucRegBuffer++);
 218:../FreeModbus/stm32/user_mb_app.c **** 			}
 219:../FreeModbus/stm32/user_mb_app.c **** 			break;
 220:../FreeModbus/stm32/user_mb_app.c ****         }
 221:../FreeModbus/stm32/user_mb_app.c ****     }
 453              		.loc 1 221 0
 454 008e 63E0     		b	.L28
 455              	.L24:
 196:../FreeModbus/stm32/user_mb_app.c ****                 iNReg --;
 456              		.loc 1 196 0
 457 0090 FC68     		ldr	r4, [r7, #12]
 458 0092 631C     		adds	r3, r4, #1
 459 0094 FB60     		str	r3, [r7, #12]
 460 0096 BB8C     		ldrh	r3, [r7, #36]
 461 0098 5A1C     		adds	r2, r3, #1
 462 009a BA84     		strh	r2, [r7, #36]	@ movhi
 463 009c FA69     		ldr	r2, [r7, #28]
 464 009e 1A44     		add	r2, r2, r3
 465 00a0 FB8A     		ldrh	r3, [r7, #22]
 466 00a2 1046     		mov	r0, r2
 467 00a4 1946     		mov	r1, r3
 468 00a6 0822     		movs	r2, #8
 469 00a8 FFF7FEFF 		bl	xMBUtilGetBits
 470 00ac 0346     		mov	r3, r0
 471 00ae 2370     		strb	r3, [r4]
 197:../FreeModbus/stm32/user_mb_app.c ****             }
 472              		.loc 1 197 0
 473 00b0 7B8C     		ldrh	r3, [r7, #34]
 474 00b2 013B     		subs	r3, r3, #1
 475 00b4 7B84     		strh	r3, [r7, #34]	@ movhi
 476              	.L23:
 194:../FreeModbus/stm32/user_mb_app.c ****             {
 477              		.loc 1 194 0 discriminator 1
 478 00b6 7B8C     		ldrh	r3, [r7, #34]
 479 00b8 002B     		cmp	r3, #0
 480 00ba E9D1     		bne	.L24
 199:../FreeModbus/stm32/user_mb_app.c **** 			usNCoils = usNCoils % 8;                        //ÓàÏÂµÄÏßÈ¦Êý	
 481              		.loc 1 199 0
 482 00bc FB68     		ldr	r3, [r7, #12]
 483 00be 013B     		subs	r3, r3, #1
 484 00c0 FB60     		str	r3, [r7, #12]
 200:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer = *pucRegBuffer <<(8 - usNCoils); //¸ßÎ»²¹Áã
 485              		.loc 1 200 0
 486 00c2 3B89     		ldrh	r3, [r7, #8]	@ movhi
 487 00c4 03F00703 		and	r3, r3, #7
 488 00c8 3B81     		strh	r3, [r7, #8]	@ movhi
 201:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer = *pucRegBuffer >>(8 - usNCoils);
 489              		.loc 1 201 0
 490 00ca FB68     		ldr	r3, [r7, #12]
 491 00cc 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 492 00ce 1A46     		mov	r2, r3
 493 00d0 3B89     		ldrh	r3, [r7, #8]
 494 00d2 C3F10803 		rsb	r3, r3, #8
 495 00d6 02FA03F3 		lsl	r3, r2, r3
 496 00da DAB2     		uxtb	r2, r3
 497 00dc FB68     		ldr	r3, [r7, #12]
 498 00de 1A70     		strb	r2, [r3]
 202:../FreeModbus/stm32/user_mb_app.c ****             break;
 499              		.loc 1 202 0
 500 00e0 FB68     		ldr	r3, [r7, #12]
 501 00e2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 502 00e4 1A46     		mov	r2, r3
 503 00e6 3B89     		ldrh	r3, [r7, #8]
 504 00e8 C3F10803 		rsb	r3, r3, #8
 505 00ec 42FA03F3 		asr	r3, r2, r3
 506 00f0 DAB2     		uxtb	r2, r3
 507 00f2 FB68     		ldr	r3, [r7, #12]
 508 00f4 1A70     		strb	r2, [r3]
 203:../FreeModbus/stm32/user_mb_app.c **** 
 509              		.loc 1 203 0
 510 00f6 2BE0     		b	.L20
 511              	.L26:
 210:../FreeModbus/stm32/user_mb_app.c ****                 iNReg--;
 512              		.loc 1 210 0
 513 00f8 BB8C     		ldrh	r3, [r7, #36]
 514 00fa 5A1C     		adds	r2, r3, #1
 515 00fc BA84     		strh	r2, [r7, #36]	@ movhi
 516 00fe FA69     		ldr	r2, [r7, #28]
 517 0100 D118     		adds	r1, r2, r3
 518 0102 FB68     		ldr	r3, [r7, #12]
 519 0104 5A1C     		adds	r2, r3, #1
 520 0106 FA60     		str	r2, [r7, #12]
 521 0108 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 522 010a FA8A     		ldrh	r2, [r7, #22]
 523 010c 0846     		mov	r0, r1
 524 010e 1146     		mov	r1, r2
 525 0110 0822     		movs	r2, #8
 526 0112 FFF7FEFF 		bl	xMBUtilSetBits
 211:../FreeModbus/stm32/user_mb_app.c ****             }
 527              		.loc 1 211 0
 528 0116 7B8C     		ldrh	r3, [r7, #34]
 529 0118 013B     		subs	r3, r3, #1
 530 011a 7B84     		strh	r3, [r7, #34]	@ movhi
 531              	.L25:
 208:../FreeModbus/stm32/user_mb_app.c ****             {
 532              		.loc 1 208 0 discriminator 1
 533 011c 7B8C     		ldrh	r3, [r7, #34]
 534 011e 012B     		cmp	r3, #1
 535 0120 EAD8     		bhi	.L26
 213:../FreeModbus/stm32/user_mb_app.c **** 			if (usNCoils != 0)                                  //xMBUtilSetBits·½·¨ ÔÚ²Ù×÷Î»ÊýÁ¿Îª0Ê±´æÔÚbu
 536              		.loc 1 213 0
 537 0122 3B89     		ldrh	r3, [r7, #8]	@ movhi
 538 0124 03F00703 		and	r3, r3, #7
 539 0128 3B81     		strh	r3, [r7, #8]	@ movhi
 214:../FreeModbus/stm32/user_mb_app.c **** 			{
 540              		.loc 1 214 0
 541 012a 3B89     		ldrh	r3, [r7, #8]
 542 012c 002B     		cmp	r3, #0
 543 012e 0ED0     		beq	.L27
 216:../FreeModbus/stm32/user_mb_app.c **** 						*pucRegBuffer++);
 544              		.loc 1 216 0
 545 0130 BB8C     		ldrh	r3, [r7, #36]
 546 0132 5A1C     		adds	r2, r3, #1
 547 0134 BA84     		strh	r2, [r7, #36]	@ movhi
 548 0136 FA69     		ldr	r2, [r7, #28]
 549 0138 D018     		adds	r0, r2, r3
 550 013a 3B89     		ldrh	r3, [r7, #8]	@ movhi
 551 013c DAB2     		uxtb	r2, r3
 217:../FreeModbus/stm32/user_mb_app.c **** 			}
 552              		.loc 1 217 0
 553 013e FB68     		ldr	r3, [r7, #12]
 554 0140 591C     		adds	r1, r3, #1
 555 0142 F960     		str	r1, [r7, #12]
 216:../FreeModbus/stm32/user_mb_app.c **** 						*pucRegBuffer++);
 556              		.loc 1 216 0
 557 0144 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 558 0146 F98A     		ldrh	r1, [r7, #22]
 559 0148 FFF7FEFF 		bl	xMBUtilSetBits
 219:../FreeModbus/stm32/user_mb_app.c ****         }
 560              		.loc 1 219 0
 561 014c FFE7     		b	.L30
 562              	.L27:
 563              	.L30:
 564 014e 00BF     		nop
 565              	.L20:
 566              		.loc 1 221 0
 567 0150 02E0     		b	.L28
 568              	.L19:
 222:../FreeModbus/stm32/user_mb_app.c ****     else
 223:../FreeModbus/stm32/user_mb_app.c ****     {
 224:../FreeModbus/stm32/user_mb_app.c ****         eStatus = MB_ENOREG;
 569              		.loc 1 224 0
 570 0152 0123     		movs	r3, #1
 571 0154 87F82730 		strb	r3, [r7, #39]
 572              	.L28:
 225:../FreeModbus/stm32/user_mb_app.c ****     }
 226:../FreeModbus/stm32/user_mb_app.c ****     return eStatus;
 573              		.loc 1 226 0
 574 0158 97F82730 		ldrb	r3, [r7, #39]	@ zero_extendqisi2
 227:../FreeModbus/stm32/user_mb_app.c **** }
 575              		.loc 1 227 0
 576 015c 1846     		mov	r0, r3
 577 015e 2C37     		adds	r7, r7, #44
 578 0160 BD46     		mov	sp, r7
 579              		@ sp needed
 580 0162 90BD     		pop	{r4, r7, pc}
 581              		.cfi_endproc
 582              	.LFE31:
 584              		.section	.text.eMBRegDiscreteCB,"ax",%progbits
 585              		.align	2
 586              		.global	eMBRegDiscreteCB
 587              		.thumb
 588              		.thumb_func
 590              	eMBRegDiscreteCB:
 591              	.LFB32:
 228:../FreeModbus/stm32/user_mb_app.c **** //****************************ÀëÉ¢ÊäÈë¼Ä´æÆ÷»Øµ÷º¯Êý********************************
 229:../FreeModbus/stm32/user_mb_app.c **** //º¯Êý¶¨Òå: eMBErrorCode eMBRegDiscreteCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNDiscre
 230:../FreeModbus/stm32/user_mb_app.c **** //Ãè    Êö£ºÀëÉ¢ÊäÈë¼Ä´æÆ÷Ïà¹ØµÄ¹¦ÄÜ£¨¶Á¡¢Á¬Ðø¶Á£©
 231:../FreeModbus/stm32/user_mb_app.c **** //Èë¿Ú²ÎÊý£ºpucRegBuffer : ÓÃµ±Ç°µÄÏßÈ¦Êý¾Ý¸üÐÂÕâ¸ö¼Ä´æÆ÷£¬ÆðÊ¼¼Ä´æÆ÷¶ÔÓ¦µÄÎ»´¦ÓÚ¸Ã×Ö½ÚpucRegBuffer
 232:../FreeModbus/stm32/user_mb_app.c **** //                         Èç¹û»Øµ÷º¯ÊýÒªÐ´Õâ¸ö»º³åÇø£¬Ã»ÓÐÓÃµ½µÄÏßÈ¦£¨ÀýÈç²»ÊÇ8¸öÒ»×éµÄÏßÈ¦×´Ì¬£©¶
 233:../FreeModbus/stm32/user_mb_app.c **** //			usAddress    : ÀëÉ¢ÊäÈëµÄÆðÊ¼µØÖ·
 234:../FreeModbus/stm32/user_mb_app.c **** //			usNDiscrete  : ÀëÉ¢ÊäÈëµãÊýÁ¿
 235:../FreeModbus/stm32/user_mb_app.c **** //³ö¿Ú²ÎÊý£ºeMBErrorCode : Õâ¸öº¯Êý½«·µ»ØµÄ´íÎóÂë
 236:../FreeModbus/stm32/user_mb_app.c **** //±¸    ×¢£ºEditor£ºArmink 2010-10-31    Company: BXXJS
 237:../FreeModbus/stm32/user_mb_app.c **** //**********************************************************************************
 238:../FreeModbus/stm32/user_mb_app.c **** eMBErrorCode
 239:../FreeModbus/stm32/user_mb_app.c **** eMBRegDiscreteCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNDiscrete )
 240:../FreeModbus/stm32/user_mb_app.c **** {
 592              		.loc 1 240 0
 593              		.cfi_startproc
 594              		@ args = 0, pretend = 0, frame = 32
 595              		@ frame_needed = 1, uses_anonymous_args = 0
 596 0000 90B5     		push	{r4, r7, lr}
 597              		.cfi_def_cfa_offset 12
 598              		.cfi_offset 4, -12
 599              		.cfi_offset 7, -8
 600              		.cfi_offset 14, -4
 601 0002 89B0     		sub	sp, sp, #36
 602              		.cfi_def_cfa_offset 48
 603 0004 00AF     		add	r7, sp, #0
 604              		.cfi_def_cfa_register 7
 605 0006 7860     		str	r0, [r7, #4]
 606 0008 1346     		mov	r3, r2
 607 000a 0A46     		mov	r2, r1	@ movhi
 608 000c 7A80     		strh	r2, [r7, #2]	@ movhi
 609 000e 3B80     		strh	r3, [r7]	@ movhi
 241:../FreeModbus/stm32/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 610              		.loc 1 241 0
 611 0010 0023     		movs	r3, #0
 612 0012 FB77     		strb	r3, [r7, #31]
 242:../FreeModbus/stm32/user_mb_app.c **** 	USHORT          iRegIndex , iRegBitIndex , iNReg;
 243:../FreeModbus/stm32/user_mb_app.c **** 	UCHAR *         pucDiscreteInputBuf;
 244:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           DISCRETE_INPUT_START;
 245:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           DISCRETE_INPUT_NDISCRETES;
 246:../FreeModbus/stm32/user_mb_app.c ****     UCHAR           usDiscreteInputStart;
 247:../FreeModbus/stm32/user_mb_app.c **** 	iNReg =  usNDiscrete / 8 + 1;        //Õ¼ÓÃ¼Ä´æÆ÷ÊýÁ¿
 613              		.loc 1 247 0
 614 0014 3B88     		ldrh	r3, [r7]
 615 0016 DB08     		lsrs	r3, r3, #3
 616 0018 9BB2     		uxth	r3, r3
 617 001a 0133     		adds	r3, r3, #1
 618 001c 7B83     		strh	r3, [r7, #26]	@ movhi
 248:../FreeModbus/stm32/user_mb_app.c **** 
 249:../FreeModbus/stm32/user_mb_app.c **** 	pucDiscreteInputBuf = ucSDiscInBuf;
 619              		.loc 1 249 0
 620 001e 40F20003 		movw	r3, #:lower16:ucSDiscInBuf
 621 0022 C0F20003 		movt	r3, #:upper16:ucSDiscInBuf
 622 0026 7B61     		str	r3, [r7, #20]
 250:../FreeModbus/stm32/user_mb_app.c **** 	DISCRETE_INPUT_START = S_DISCRETE_INPUT_START;
 623              		.loc 1 250 0
 624 0028 0023     		movs	r3, #0
 625 002a FB74     		strb	r3, [r7, #19]
 251:../FreeModbus/stm32/user_mb_app.c **** 	DISCRETE_INPUT_NDISCRETES = S_DISCRETE_INPUT_NDISCRETES;
 626              		.loc 1 251 0
 627 002c 0023     		movs	r3, #0
 628 002e BB74     		strb	r3, [r7, #18]
 252:../FreeModbus/stm32/user_mb_app.c **** 	usDiscreteInputStart = usSDiscInStart;
 629              		.loc 1 252 0
 630 0030 40F20003 		movw	r3, #:lower16:usSDiscInStart
 631 0034 C0F20003 		movt	r3, #:upper16:usSDiscInStart
 632 0038 1B88     		ldrh	r3, [r3]
 633 003a 7B74     		strb	r3, [r7, #17]
 253:../FreeModbus/stm32/user_mb_app.c **** 
 254:../FreeModbus/stm32/user_mb_app.c **** 	usAddress--;//FreeModbus¹¦ÄÜº¯ÊýÖÐÒÑ¾­¼Ó1£¬Îª±£Ö¤Óë»º³åÇøÊ×µØÖ·Ò»ÖÂ£¬¹Ê¼õ1
 634              		.loc 1 254 0
 635 003c 7B88     		ldrh	r3, [r7, #2]
 636 003e 013B     		subs	r3, r3, #1
 637 0040 7B80     		strh	r3, [r7, #2]	@ movhi
 255:../FreeModbus/stm32/user_mb_app.c ****     if( ( usAddress >= DISCRETE_INPUT_START )
 638              		.loc 1 255 0
 639 0042 FB7C     		ldrb	r3, [r7, #19]	@ zero_extendqisi2
 640 0044 9BB2     		uxth	r3, r3
 641 0046 7A88     		ldrh	r2, [r7, #2]
 642 0048 9A42     		cmp	r2, r3
 643 004a 4FD3     		bcc	.L32
 256:../FreeModbus/stm32/user_mb_app.c ****         && ( usAddress + usNDiscrete <= DISCRETE_INPUT_START + DISCRETE_INPUT_NDISCRETES ) )
 644              		.loc 1 256 0
 645 004c 7A88     		ldrh	r2, [r7, #2]
 646 004e 3B88     		ldrh	r3, [r7]
 647 0050 1A44     		add	r2, r2, r3
 648 0052 F97C     		ldrb	r1, [r7, #19]	@ zero_extendqisi2
 649 0054 BB7C     		ldrb	r3, [r7, #18]	@ zero_extendqisi2
 650 0056 0B44     		add	r3, r3, r1
 651 0058 9A42     		cmp	r2, r3
 652 005a 47DC     		bgt	.L32
 257:../FreeModbus/stm32/user_mb_app.c ****     {
 258:../FreeModbus/stm32/user_mb_app.c ****         iRegIndex    = ( int )( usAddress - usDiscreteInputStart ) / 8 ;    //Ã¿¸ö¼Ä´æÆ÷´æ8¸ö
 653              		.loc 1 258 0
 654 005c 7A88     		ldrh	r2, [r7, #2]
 655 005e 7B7C     		ldrb	r3, [r7, #17]	@ zero_extendqisi2
 656 0060 D31A     		subs	r3, r2, r3
 657 0062 DA1D     		adds	r2, r3, #7
 658 0064 002B     		cmp	r3, #0
 659 0066 B8BF     		it	lt
 660 0068 1346     		movlt	r3, r2
 661 006a DB10     		asrs	r3, r3, #3
 662 006c BB83     		strh	r3, [r7, #28]	@ movhi
 259:../FreeModbus/stm32/user_mb_app.c **** 		iRegBitIndex = ( int )( usAddress - usDiscreteInputStart ) % 8 ;	   //Ïà¶ÔÓÚ¼Ä´æÆ÷ÄÚ²¿µÄÎ»µØÖ·
 663              		.loc 1 259 0
 664 006e 7A88     		ldrh	r2, [r7, #2]
 665 0070 7B7C     		ldrb	r3, [r7, #17]	@ zero_extendqisi2
 666 0072 D21A     		subs	r2, r2, r3
 667 0074 D317     		asrs	r3, r2, #31
 668 0076 5B0F     		lsrs	r3, r3, #29
 669 0078 1A44     		add	r2, r2, r3
 670 007a 02F00702 		and	r2, r2, #7
 671 007e D31A     		subs	r3, r2, r3
 672 0080 FB81     		strh	r3, [r7, #14]	@ movhi
 260:../FreeModbus/stm32/user_mb_app.c **** 
 261:../FreeModbus/stm32/user_mb_app.c **** 		while (iNReg > 0)
 673              		.loc 1 261 0
 674 0082 12E0     		b	.L33
 675              	.L34:
 262:../FreeModbus/stm32/user_mb_app.c **** 		{
 263:../FreeModbus/stm32/user_mb_app.c **** 			*pucRegBuffer++ = xMBUtilGetBits(&pucDiscreteInputBuf[iRegIndex++],
 676              		.loc 1 263 0
 677 0084 7C68     		ldr	r4, [r7, #4]
 678 0086 631C     		adds	r3, r4, #1
 679 0088 7B60     		str	r3, [r7, #4]
 680 008a BB8B     		ldrh	r3, [r7, #28]
 681 008c 5A1C     		adds	r2, r3, #1
 682 008e BA83     		strh	r2, [r7, #28]	@ movhi
 683 0090 7A69     		ldr	r2, [r7, #20]
 684 0092 1A44     		add	r2, r2, r3
 685 0094 FB89     		ldrh	r3, [r7, #14]
 686 0096 1046     		mov	r0, r2
 687 0098 1946     		mov	r1, r3
 688 009a 0822     		movs	r2, #8
 689 009c FFF7FEFF 		bl	xMBUtilGetBits
 690 00a0 0346     		mov	r3, r0
 691 00a2 2370     		strb	r3, [r4]
 264:../FreeModbus/stm32/user_mb_app.c **** 					iRegBitIndex, 8);
 265:../FreeModbus/stm32/user_mb_app.c **** 			iNReg--;
 692              		.loc 1 265 0
 693 00a4 7B8B     		ldrh	r3, [r7, #26]
 694 00a6 013B     		subs	r3, r3, #1
 695 00a8 7B83     		strh	r3, [r7, #26]	@ movhi
 696              	.L33:
 261:../FreeModbus/stm32/user_mb_app.c **** 		{
 697              		.loc 1 261 0 discriminator 1
 698 00aa 7B8B     		ldrh	r3, [r7, #26]
 699 00ac 002B     		cmp	r3, #0
 700 00ae E9D1     		bne	.L34
 266:../FreeModbus/stm32/user_mb_app.c **** 		}
 267:../FreeModbus/stm32/user_mb_app.c **** 		pucRegBuffer--;
 701              		.loc 1 267 0
 702 00b0 7B68     		ldr	r3, [r7, #4]
 703 00b2 013B     		subs	r3, r3, #1
 704 00b4 7B60     		str	r3, [r7, #4]
 268:../FreeModbus/stm32/user_mb_app.c **** 		usNDiscrete = usNDiscrete % 8; //ÓàÏÂµÄÏßÈ¦Êý
 705              		.loc 1 268 0
 706 00b6 3B88     		ldrh	r3, [r7]	@ movhi
 707 00b8 03F00703 		and	r3, r3, #7
 708 00bc 3B80     		strh	r3, [r7]	@ movhi
 269:../FreeModbus/stm32/user_mb_app.c **** 		*pucRegBuffer = *pucRegBuffer << (8 - usNDiscrete); //¸ßÎ»²¹Áã
 709              		.loc 1 269 0
 710 00be 7B68     		ldr	r3, [r7, #4]
 711 00c0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 712 00c2 1A46     		mov	r2, r3
 713 00c4 3B88     		ldrh	r3, [r7]
 714 00c6 C3F10803 		rsb	r3, r3, #8
 715 00ca 02FA03F3 		lsl	r3, r2, r3
 716 00ce DAB2     		uxtb	r2, r3
 717 00d0 7B68     		ldr	r3, [r7, #4]
 718 00d2 1A70     		strb	r2, [r3]
 270:../FreeModbus/stm32/user_mb_app.c **** 		*pucRegBuffer = *pucRegBuffer >>(8 - usNDiscrete);
 719              		.loc 1 270 0
 720 00d4 7B68     		ldr	r3, [r7, #4]
 721 00d6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 722 00d8 1A46     		mov	r2, r3
 723 00da 3B88     		ldrh	r3, [r7]
 724 00dc C3F10803 		rsb	r3, r3, #8
 725 00e0 42FA03F3 		asr	r3, r2, r3
 726 00e4 DAB2     		uxtb	r2, r3
 727 00e6 7B68     		ldr	r3, [r7, #4]
 728 00e8 1A70     		strb	r2, [r3]
 729 00ea 01E0     		b	.L35
 730              	.L32:
 271:../FreeModbus/stm32/user_mb_app.c ****     }
 272:../FreeModbus/stm32/user_mb_app.c ****     else
 273:../FreeModbus/stm32/user_mb_app.c ****     {
 274:../FreeModbus/stm32/user_mb_app.c ****         eStatus = MB_ENOREG;
 731              		.loc 1 274 0
 732 00ec 0123     		movs	r3, #1
 733 00ee FB77     		strb	r3, [r7, #31]
 734              	.L35:
 275:../FreeModbus/stm32/user_mb_app.c ****     }
 276:../FreeModbus/stm32/user_mb_app.c **** 
 277:../FreeModbus/stm32/user_mb_app.c ****     return eStatus;
 735              		.loc 1 277 0
 736 00f0 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 278:../FreeModbus/stm32/user_mb_app.c **** }
 737              		.loc 1 278 0
 738 00f2 1846     		mov	r0, r3
 739 00f4 2437     		adds	r7, r7, #36
 740 00f6 BD46     		mov	sp, r7
 741              		@ sp needed
 742 00f8 90BD     		pop	{r4, r7, pc}
 743              		.cfi_endproc
 744              	.LFE32:
 746 00fa 00BF     		.text
 747              	.Letext0:
 748              		.file 2 "c:\\tools\\arm-none-eabi\\include\\stdint.h"
 749              		.file 3 "D:\\pall\\workspace\\Snack_stm32_drv_modbus\\FreeModbus\\stm32/port.h"
 750              		.file 4 "D:\\pall\\workspace\\Snack_stm32_drv_modbus\\FreeModbus\\include/mb.h"
 751              		.file 5 "D:\\pall\\workspace\\Snack_stm32_drv_modbus\\Libraries\\CMSIS/core_cm3.h"
DEFINED SYMBOLS
                            *ABS*:00000000 user_mb_app.c
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:23     .bss.usSDiscInStart:00000000 usSDiscInStart
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:20     .bss.usSDiscInStart:00000000 $d
                            *COM*:00000000 ucSDiscInBuf
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:31     .bss.usSCoilStart:00000000 usSCoilStart
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:28     .bss.usSCoilStart:00000000 $d
                            *COM*:00000000 ucSCoilBuf
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:39     .data.usSRegInStart:00000000 usSRegInStart
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:36     .data.usSRegInStart:00000000 $d
                            *COM*:00000008 usSRegInBuf
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:47     .bss.usSRegHoldStart:00000000 usSRegHoldStart
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:44     .bss.usSRegHoldStart:00000000 $d
                            *COM*:00000000 usSRegHoldBuf
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:51     .text.eMBRegInputCB:00000000 $t
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:56     .text.eMBRegInputCB:00000000 eMBRegInputCB
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:178    .text.eMBRegHoldingCB:00000000 $t
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:183    .text.eMBRegHoldingCB:00000000 eMBRegHoldingCB
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:359    .text.eMBRegCoilsCB:00000000 $t
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:364    .text.eMBRegCoilsCB:00000000 eMBRegCoilsCB
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:585    .text.eMBRegDiscreteCB:00000000 $t
C:\Users\Alex\AppData\Local\Temp\ccJA3cX8.s:590    .text.eMBRegDiscreteCB:00000000 eMBRegDiscreteCB
                     .debug_frame:00000010 $d
                           .group:00000000 wm4.1.98ffea2db242cfdb58f411f7407f2b59
                           .group:00000000 wm4.stm32f10x_conf.h.2.f1a8c33f0a763aeef696fee38b2b2dbc
                           .group:00000000 wm4.mbconfig.h.33.2e295d4ff98bc723e2405a40490b5ddb
                           .group:00000000 wm4.newlib.h.8.384a112feabb3bef7b573ae48cde2e3b
                           .group:00000000 wm4.features.h.22.6a4ca7cd053637cc1d0db6c16f39b2d7
                           .group:00000000 wm4.config.h.183.aa62afef667fb61d15fa64c48beb2f14
                           .group:00000000 wm4._ansi.h.23.5644b60c990a4800b02a6e654e88f93a
                           .group:00000000 wm4.assert.h.11.060c3dc511517628fd4f958fa9448dce
                           .group:00000000 wm4.stdint.h.20.54ad762faa59e3c05491630641c8d8bf
                           .group:00000000 wm4.stddef.h.263.49e44f5ee9cdd8820580fc4aa239e32a
                           .group:00000000 wm4.inttypes.h.24.8137491c6995c2cb5d25f9bab92d7f64
                           .group:00000000 wm4.stm32f10x.h.51.b859cb68ed44ee02c916b41cb8c68f1c
                           .group:00000000 wm4.core_cm3.h.25.119fe996be41b62fbd915b59177e39d1
                           .group:00000000 wm4.stm32f10x.h.522.a925aafc848b1f088438cf0e9b167b78
                           .group:00000000 wm4.stm32f10x.h.8304.f7d8ad90959e99679b3257267c3aadfe
                           .group:00000000 wm4.stm32f10x_rcc.h.25.fe8897e7491f2eb0cff54551d08eb765
                           .group:00000000 wm4.portmacro.h.56.a47bdd86bc36d334ca6056492e2d709f
                           .group:00000000 wm4.port.h.38.a8cf679bb58c5ad1b387e726c220530e
                           .group:00000000 wm4.mbproto.h.32.da85c2bdd9bdb84e975a92c999a4b490
                           .group:00000000 wm4.mb_m.h.32.f0c90bdd8de56a09521e2eefafb4f11f
                           .group:00000000 wm4.mbframe.h.32.cb3fc2a5a44fcaf8fe721dce49a4ba3c
                           .group:00000000 wm4.user_mb_app.h.11.96b8d37bcfd7b0faa6253a624dac5430

UNDEFINED SYMBOLS
xMBUtilGetBits
xMBUtilSetBits
