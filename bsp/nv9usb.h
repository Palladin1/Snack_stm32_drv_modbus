/*
*********************************************************************************************************
*
*                                           VALIDATOR INTERFACE
*
* Filename      : NV9USB.h
* Version       : V1.00
* Programmer(s) : Palladin,  male - Participant@pochta.ru
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                               MODULE
*********************************************************************************************************
*/
#ifndef __NV9USB_H_
#define __NV9USB_H_

/*
*********************************************************************************************************
*                                             INCLUDE FILES
*********************************************************************************************************
*/
#include "stm32f10x.h"

/*
*********************************************************************************************************
*                                               EXTERNS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                               DEFINES
*********************************************************************************************************
*/
#define VALIDATOR_PERIOD_MS    1

#define	VALIDATOR_INHIBIT   GPIOC, GPIO_Pin_0
#define	VALIDATOR_STATUS    GPIOC, GPIO_Pin_1
#define	VALIDATOR_PULS_IN   GPIOC, GPIO_Pin_2
#define	VALIDATOR_ESCROW    GPIOC, GPIO_Pin_3
#define	VALIDATOR_PWR_PIN   GPIOA, GPIO_Pin_0


#define VALIDATOR_INHIBIT_DISABLE() 	GPIO_SetBits(VALIDATOR_INHIBIT)
#define VALIDATOR_INHIBIT_ENABLE()  	GPIO_ResetBits(VALIDATOR_INHIBIT)

/*
*********************************************************************************************************
*                                          GLOBAL VARIABLES
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                               MACRO'S
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                              DATA TYPES
*********************************************************************************************************
*/
typedef struct validator {
	u32 PeriodCntMin;
	u32 PeriodCntMax;
	u32 PeriodCntCar;
	u32 MoneyQuantity;
	u32 SynchroFlag;
} validator_t;

/*
*********************************************************************************************************
*                                         FUNCTION PROTOTYPES
*********************************************************************************************************
*/
u32  ValidatorMoneyQuantity(void);
void ValidatorPulseProcessing(u32 call_period);
void ValidatorInit(u32 period_cnt_min, u32 period_cnt_max);


/*
*********************************************************************************************************
*                                        CONFIGURATION ERRORS
*********************************************************************************************************
*/


/*
*********************************************************************************************************
*                                             MODULE END
*********************************************************************************************************
*/

#endif    /* NV9USB_H */
